import{g as M,u as T,j as t,r as m,D as q,q as g}from"./index.js";import{r as y,x as l,B as f,f as F,C as E,M as V,c as d,o as Y,E as A,J as R,i as N,s as r}from"./antd.js";import{S as O}from"./MutationHooks.js";import"./reactRouterDom.js";import"./zustand.js";const{Title:K,Text:n}=N,H=()=>{const{data:u}=M(),[b,j]=y.useState(0),P=[{value:"monthly",label:"Monthly"},{value:"biMonthly",label:"Bi-Monthly"},{value:"quarterly",label:"Quarterly"},{value:"halfYearly",label:"Half-Yearly"},{value:"yearly",label:"Yearly"},{value:"biYearly",label:"Bi-Yearly"},{value:"triYearly",label:"Tri-Yearly"},{value:"lifeTime",label:"Life Time"}],[C,i]=y.useState(!1),[o,x]=y.useState(!1),[c]=l.useForm(),p=T(e=>e.CurrentUserData.id),k=()=>{x(!1),c.resetFields(),i(!0)},v=e=>{console.log("plan",e),j(e.id||0),x(!0),c.setFieldsValue({...e,active:e.status==="active"}),i(!0)},I=()=>o?m.backend.updatePlan+`/${b}`:m.backend.createPlan,{mutate:h}=O({mutationKey:["createPlan"],queryKeyToInvalidate:["Plans"],getSuccessMessage:e=>`Plan ${e.id?"updated":"created"} successfully`,getErrorMessage:e=>`Failed to ${e.id?"update":"create"} stay: ${e}`,onMutateCallback:e=>console.log("onMutateCallback",e),onSettledCallback:(e,a,s,B)=>console.log("onSettledCallback",e,a,s,B),routes:I(),isUpdate:o}),D=()=>{c.validateFields().then(e=>{if(o){console.log("Edit",e);const a={name:e.name,description:e.description,benefits:e.benefits,validity:e.validity,titleDescription:e.titleDescription,renewal:e.renewal,price:e.price,planDate:new Date().toISOString(),status:e.active?"active":"inactive",userId:p};h(a,{onSuccess:s=>{console.log("response",s),s.statusCode===200?(r.success("Plan updated successfully!"),c.resetFields(),i(!1)):(r.error("Failed to save Plan"),i(!1))}})}else{console.log(e);const a={name:e.name,description:e.description,benefits:e.benefits,validity:e.validity,titleDescription:e.titleDescription,renewal:e.renewal,planDate:new Date().toISOString(),price:e.price,userId:p};h(a,{onSuccess:s=>{console.log("response",s),s.statusCode===200?(r.success("Plan saved successfully!"),c.resetFields(),i(!1)):(r.error("Failed to save Plan"),i(!1))}})}}).catch(e=>{console.error("Validation failed:",e),r.error("Validation failed. Please check the form fields and try again.")})},w=()=>{i(!1)};console.log("plans",u);const S=async e=>{if(confirm("Are you sure you want to delete this plan?")){const a=await q(m.backend.deletePlan,{userId:p,id:e});if(a.statusCode===200){r.success("plan deleted successfully");const s=await g.invalidateQueries({queryKey:["Plans"]});console.log("data",g.getQueriesData({queryKey:["Plans"]})),console.log("data",s)}else r.error({content:a.message,key:"updatable",duration:2})}};return t.jsxs("div",{style:{padding:"20px"},children:[t.jsx(f,{type:"primary",style:{marginBottom:"20px"},onClick:k,children:"Create Plan"}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"20px",cursor:"pointer"},children:u==null?void 0:u.map((e,a)=>t.jsxs("div",{style:{position:"relative",width:"350px"},className:"group",children:[t.jsx(f,{icon:t.jsx(F,{}),onClick:s=>{s.stopPropagation(),e.id!==void 0&&S(e.id)},className:"absolute top-2 right-2 bg-red-500 text-white p-2 rounded-full shadow transform scale-0 group-hover:scale-100 transition-transform duration-200 hover:bg-red-700 flex items-center justify-center",style:{zIndex:10}}),t.jsxs(E,{style:{width:"100%",border:"2px solid #FF5733",borderRadius:"15px",boxShadow:"0 6px 12px rgba(255, 87, 51, 0.3)",padding:"20px",background:"#fff"},bodyStyle:{padding:0},onClick:()=>v(e),children:[t.jsx("div",{style:{textAlign:"center",marginBottom:"15px"},children:t.jsx(K,{level:4,style:{margin:0,color:"#333"},children:e.name})}),e.titleDescription&&t.jsx(n,{type:"secondary",style:{display:"block",marginBottom:"10px",color:"#555"},children:e.titleDescription}),t.jsx(n,{style:{display:"block",marginBottom:"10px",color:"#333"},children:e.description}),t.jsxs(n,{style:{display:"block",marginBottom:"10px",color:"#333"},children:[t.jsx("strong",{children:"Benefit:"})," ",e.benefits]}),t.jsxs(n,{style:{display:"block",marginBottom:"10px",color:"#333"},children:[t.jsx("strong",{children:"Renewal:"})," ",e.renewal]}),t.jsxs(n,{style:{display:"block",marginBottom:"10px",color:"#333"},children:[t.jsx("strong",{children:"Validity:"})," ",e.validity]}),t.jsxs(n,{style:{display:"block",marginBottom:"10px",color:"#333"},children:[t.jsx("strong",{children:"Price:"})," ",e.price]}),t.jsxs(n,{style:{display:"block",marginBottom:"10px",color:"#333"},children:[t.jsx("strong",{children:"Status:"})," ",e.status]})]})]},a))}),t.jsx(V,{title:o?"Edit Plan":"Create Plan",open:C,onOk:D,onCancel:w,okText:o?"Save":"Create",cancelText:"Close",children:t.jsxs(l,{form:c,layout:"vertical",children:[t.jsx(l.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please input the name!"}],children:t.jsx(d,{})}),t.jsx(l.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please input the description!"}],children:t.jsx(d.TextArea,{})}),t.jsx(l.Item,{name:"titleDescription",label:"Title Description",children:t.jsx(d,{})}),t.jsx(l.Item,{name:"benefits",label:"Benefits",rules:[{required:!0,message:"Please input the Benefits!"}],children:t.jsx(d,{})}),t.jsx(l.Item,{name:"renewal",label:"Renewal",rules:[{required:!0,message:"Please input the renewal period!"}],children:t.jsx(d,{})}),t.jsx(l.Item,{name:"validity",label:"Validity",rules:[{required:!0,message:"Please input the Validty"}],children:t.jsx(Y,{options:P})}),t.jsx(l.Item,{name:"price",label:"Price",rules:[{required:!0,message:"Please input the Price"}],children:t.jsx(A,{})}),o&&t.jsx(l.Item,{name:"active",label:"Active",valuePropName:"checked",children:t.jsx(R,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})})]})};export{H as default};
